<!DOCTYPE html>
<html lang="en" style="width: 890px;">
    <head>
        <meta charset="utf-8"/>
        <title>stupid</title>
        <link rel="stylesheet" href="style.css">
        <script src="windows.js" type="text/javascript"></script>
        <link rel="stylesheet" href="https://unpkg.com/xp.css"/>
    </head>
<body style="background-image: url('new/window/bliss.png'); background-size: 100% 100%; background-attachment: fixed; background-repeat: no-repeat;" onload="startTime()">
    <header>

    </header>

    <main>

    <script>var windows_array = [];</script>
  
    <!--WELCOME WINDOW-->
    <div class="window" id="window_welcome" style="user-select: none; position: absolute; top: 100px; width: 300px">
      <div class="title-bar" id="window_welcome_header">
        <div class="title-bar-text" style="cursor:default;">
          Welcome!
        </div>

        <div class="title-bar-controls" id="window_welcome_header_controls" onmousedown="event.stopPropagation()">
          <button aria-label="Close" id="close_button" onclick="windowClose('window_welcome')"></button>
        </div>

      </div>
      <div class="window-body">
        <p>Hello, world!</p>
        <section class="field-row" style="justify-content: flex-end">
          <button>OK</button>
          <button>Cancel</button>
        </section>
      </div>
    </div>
    <script>dragElement(document.getElementById("window_welcome"));windows_array.push(document.getElementById("window_welcome"))</script>

    <!--TEST WINDOW-->
    <div class="window" id="window_test" style="user-select: none; position: absolute; top: 200px; width: 300px">
      <div class="title-bar" id="window_test_header">
        <div class="title-bar-text" style="cursor:default;">
          Idk
        </div>

        <div class="title-bar-controls" id="window_test_header_controls" onmousedown="event.stopPropagation()">
          <button aria-label="Close" id="close_button" onclick="windowClose('window_test')"></button>
        </div>

      </div>
      <div class="window-body">
        <p>Lorem ipsum sraken pierdaken</p>
        <section class="field-row" style="justify-content: flex-end">
          <button>OK</button>
          <button>Cancel</button>
        </section>
      </div>
    </div>
    <script>dragElement(document.getElementById("window_test"));windows_array.push(document.getElementById("window_test"))</script>

    <!--CONSOLE WINDOW-->
    <div class="window" id="window_console" style="user-select: none; position: absolute;">
        <div class="title-bar" id="window_console_header">
            <div class="title-bar-text">Command Prompt</div>
            <div class="title-bar-controls" id="window_console_header_controls" onmousedown="event.stopPropagation()">
            <button aria-label="Close" id="close_button" onclick="windowClose('window_console')"></button>
            </div>
        </div>
        <div class="window-body">
            <pre>Microsoft&#10094;R&#10095; Windows DOS 
                &#10094;C&#10095; Copyright Microsoft Corp 1990-2001.
            <br>C:&#92;WINDOWS&#92;SYSTEM32> You can build a command line easily with a window and pre tag
            
            </pre>
        </div>
    </div>
    <script>dragElement(document.getElementById("window_console"));windows_array.push(document.getElementById("window_console"))</script>

    <!--TASKBAR-->
    <div>
        <img id="taskbar" src="new/window/taskbar.png" style="user-select: none; position:fixed; width: 100%; height: 28px; left: 0px; bottom: 0;">
        <script>document.getElementById("taskbar").ondragstart = function(){return false;}</script>
        <!--CLOCK-->
        <p style="user-select: none; font-family: Tahoma; color: white; position:fixed; width: 100%; height: 28px; right: 20px; bottom: -19px; text-align: right; text-shadow: 1px 1px 2px #0a0a0a;" id="clock"></p>
        <!--START BUTTON-->
        <img src="new/window/startbutton_default.png" id="startbutton" style="user-select: none; position:fixed; height: 28px; left: 0px; bottom: 0;">
    </div>

    
    

    </main>

    <footer>

    </footer>

    <script>

        // Z index ordering _ready
        for(var i = 0; i <= windows_array.length - 1; i++) {
            setIndex(windows_array[i], 0);
        }

        // Start button
        var start_button = document.getElementById("startbutton");
        
        if (start_button) {
            start_button.ondragstart = function(){return false;}
            start_button.onmouseenter = function(){start_button.src = "new/window/startbutton_hover.png";}
            start_button.onmouseleave = function(){start_button.src = "new/window/startbutton_default.png";}
            start_button.onmouseup = function(){start_button.src = "new/window/startbutton_default.png";}
            start_button.onmousedown = function(){start_button.src = "new/window/startbutton_click.png";}
        }

        
        // Close window
        function windowClose(window_id) {
            var window = document.getElementById(window_id);
            window.remove();
        }

        function setIndex(item, index) {
            item.style.zIndex = index;
        }

        function windowFocus(window) {

            for(var i = 0; i <= windows_array.length - 1; i++) {
                windows_array[i].style.zIndex = 0;
            }
            if (window) window.style.zIndex = 1;

        }

        // Main loop
        var loop = function() {

            // Z index ordering _loop
            for(let i = 0; i <= windows_array.length - 1; i++) {
                if (windows_array[i]) {
                    
                    windows_array[i].onmousedown = function() {
                        windowFocus(windows_array[i]);
                    }

                }
            }


            window.requestAnimationFrame(loop);

        }

        loop()

    </script>
    <script>
        function startTime() {
                const today = new Date();
                let h = today.getHours();
                let m = today.getMinutes();
                let s = today.getSeconds();
                m = checkTime(m);
                s = checkTime(s);
                document.getElementById('clock').innerHTML =  h + ":" + m + ":" + s;
                setTimeout(startTime, 1000);
            }

            function checkTime(i) {
                if (i < 10) {i = "0" + i};
                    return i;
            }
    </script>
</body>
</html>